openapi: 3.0.0
info:
  title: wasaText
  version: 1.0.0
  description: API per il progetto wasaText

paths:
  #path per identificare la lista di utenti 
  /user: 
    #GET per ottenere la lista di tutti gli utenti
    get:
      tags: ['utente'] 
      operationId: getListOfUser
      summary: ritorna la lista di tutti gli utenti 
      description: |
        ritorna la lista degli utenti presenti nel sistema 
      responses:
        '200':
          description: lista degli utenti 
          content: 
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'

    #POST metodo per inserire un nuovo utente
    post:
      tags: ['utente']
      operationId: createUser
      summary: crea un nuovo utente 
      description: |
        crea un nuovo utente e restituisce il suo id 
      requestBody:
        required: true 
        content:
          application/json: 
            schema:
              type: object
              properties:
                username: 
                  type: string
                  example: marta
              required:
              - username
      responses:
        '201':
          description: utente creato con successo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        # codici di errore da implementare (non me li ricordo)

  #path per identificare il sihngolo utente
  /user/{userID}:
    parameters:
      - $ref: '#/components/parameters/userID'

    #GET ottiene un utente in particolare desiderato 
    get: 
      tags: ['utente']
      operationId: getParticularUser
      description: get a single user by the id 
      summary: get user by Id
      responses:
        '200':
          description: a single user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404': { $ref: '#/components/responses/ErrorResponse'}

    #PUT aggiorna un utente esistente
    put:
      tags: ['utente']
      operationId: updateUser
      summary: aggiorna un utente
      description: aggiorna un utente trmite il suo id
      requestBody:
        required: true
        content: 
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: "nuovo username"
      responses:
        '200':
          description: utente aggiornato con successo 
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '404': { $ref: '#/components/responses/ErrorResponse'}

    # DELETE elimina un utente 
    delete:
      tags: ['utente']
      operationId: deleteUser
      summary: elimina un utente con il suo id
      responses:
        '204':
          description: utente eliminato con successo
        '404': { $ref: '#/components/responses/ErrorResponse'}

  #path per identificare la lista di conversazioni di un determinato utente 
  /conversation/:
    #GET per ottenere la lista di tutte le conversazioni
    get:
      tags: ['conversazione'] 
      operationId: getMyConversations
      
    #POST
    post:
      tags: ['conversazione']
      summary: Crea una nuova conversazione
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Conversation'
      responses:
        '201':
          description: Conversazione creata
        '400':
          description: Dati non validi


  /conversation/{conversationID}:
    parameters:
      - $ref: '#/components/parameters/conversationID'

    #GET ottiene un utente in particolare desiderato 
    get: 
      tags: ['conversazione']
      operationId: getParticularConversation
      description: get a conversation by the id 
      summary: get conversation by Id
      responses:
        '200':
          description: a single conversation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '404': { $ref: '#/components/responses/ErrorResponse'}

    #PUT aggiorna un utente esistente
    put:
      tags: ['conversazione']
      operationId: updateConversation
      summary: update a conversation
      description: update a conversation by the id
      requestBody:
        required: true
        content: 
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: "nuovo nome conversazione"
      responses:
        '200':
          description: conversazione aggiornata con successo 
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '404': { $ref: '#/components/responses/ErrorResponse'}

    # DELETE elimina un utente 
    delete:
      tags: ['conversazione']
      operationId: deleteConversation
      summary: elimina una conversazione con il suo id
      responses:
        '204':
          description: conversazione eliminata con successo
        '404': { $ref: '#/components/responses/ErrorResponse'}

    
  /conversation/{conversationID}/messages/:
    parameters:
      - $ref: '#/components/parameters/conversationID'
    post:
      tags: ['message']
      summary: Invia un messaggio in una conversazione
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Message'
      responses:
        '201':
          description: Messaggio inviato
        '400':
          description: Dati non validi
    get:
      tags: ['message']
      summary: Recupera i messaggi di una conversazione
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Lista dei messaggi
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Message'
        '404':
          description: Conversazione non trovata
  #/conversation/{conversationID}/messages/{messageID}:






components:
  #schemi per definire oggetti 
  schemas: 
    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        username:
          type: string
          example: "marta"
    Group:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: "gruppo di lavoro"
        members:
          type: array
          items:
            type: User
    Conversation:
      type: object
      properties:
        participants:
          type: array
          items:
            type: string
      required:
        - participants
    Message:
      type: object
      properties:
        sender:
          type: string
          example: "marta"
        content:
          type: string
          example: "Ciao a tutti!"
        timestamp:
          type: string
          format: date-time
          example: "2023-10-01T12:00:00Z"
        conversationId:
          type: integer
          example: 1


  #parametri utilizzati come richieste dell'utente
  parameters:
    userID:
      name: userID
      in: path 
      required: true
      schema: 
        type: integer
      description: l'identificazione univoca dell'utente 

    groupID:
      name: groupID
      in: path
      required: true
      schema:
        type: integer
      description: l'identificazione univoca del gruppo

    conversationID:
      name: conversationID
      in: path
      required: true
      schema:
        type: integer
      description: l'identificazione univoca della conversazione
    
    messageID:
      name: messageID
      in: path
      required: true
      schema:
        type: integer
      description: l'identificazione univoca del messaggio


    
    
  #risposte di errore predefinite
  responses:
    ErrorResponse:
      description: risposta di errore
      content:
        application/json:
          schema:
            type: object
            properties:
              code:
                type: integer
                example: 404
              message:
                type: string
                example: "element not found"
